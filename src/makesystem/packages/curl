#!/bin/bash

NAME="curl"
VERSION="7.71.1"

{ time \ 
    {
        tar -xf curl-$VERSION.tar.xz &&
        cd curl-$VERSION &&

        patch -Np1 -i ../curl-$VERSION-security_fixes-1.patch &&
        ./configure --prefix=/usr                           \
                --disable-static                        \
                --enable-threaded-resolver              \
                --with-ca-path=/etc/ssl/certs &&
        
        make &&
        make install &&
        rm -rf docs/examples/.deps &&
        find docs \( -name Makefile\* -o -name \*.1 -o -name \*.3 \) -exec rm {} \; &&

        install -v -d -m755 /usr/share/doc/curl-7.71.1 &&
        cp -v -R docs/*     /usr/share/doc/curl-7.71.1
    }
} 2>&1 | tee /var/log/system_building/packages/$NAME.log